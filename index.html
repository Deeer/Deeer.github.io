<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>


    <meta name="description" content="ä»£ç æ‰‹å·¥è‰ºäºº | Love Linux  | è¿½æ±‚ä½“éªŒ" />



  <meta name="keywords" content="Love,Dee" />



  <link rel="alternate" href="/atom.xml" title="Dee+'s Blog" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    analytics: {
      baidu: '',
      google: ''
    },
    sidebar: 'post'
  };
</script>




  <title> Dee+'s Blog </title>
</head>

<body>
<!--[if lte IE 8]> <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'> <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari." style='margin-left:auto;margin-right:auto;display: block;'/></a></div> <![endif]-->
  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Dee+'s Blog</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>


  <ul id="menu" class="menu">
     
    
      
      <li class="menu-item menu-item-home">
        <a href="/">
          <i class="menu-item-icon icon-home"></i> <br />
          Home
        </a>
      </li>
    
      
      <li class="menu-item menu-item-categories">
        <a href="/categories">
          <i class="menu-item-icon icon-categories"></i> <br />
          Categories
        </a>
      </li>
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives">
          <i class="menu-item-icon icon-archives"></i> <br />
          Archives
        </a>
      </li>
    
      
      <li class="menu-item menu-item-tags">
        <a href="/tags">
          <i class="menu-item-icon icon-tags"></i> <br />
          Tags
        </a>
      </li>
    
      
      <li class="menu-item menu-item-about">
        <a href="/about">
          <i class="menu-item-icon icon-about"></i> <br />
          About
        </a>
      </li>
    
  </ul>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <div id="posts" class="posts-expand">
    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/06/27/runtimeæºç é˜…è¯»ï¼ˆä¸€ï¼‰/">
                runtimeæºç é˜…è¯»ï¼ˆä¸€ï¼‰
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2018-06-27
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Read-iOS/">Read iOS</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="runtimeæºç é˜…è¯»"><a href="#runtimeæºç é˜…è¯»" class="headerlink" title="runtimeæºç é˜…è¯»"></a>runtimeæºç é˜…è¯»</h2><p>é¦–å…ˆæ˜¯å¯¹è±¡çš„åˆå§‹åŒ–</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  void _objcInit(void) &#123;</span><br><span class="line">	static int _done = <span class="number">0</span>;</span><br><span class="line">	int hidx;</span><br><span class="line">        <span class="comment">/* Protect against multiple invocations, as all library</span></span><br><span class="line"><span class="comment">         * initializers should. */</span></span><br><span class="line">        if (<span class="number">0</span> != _done) return;</span><br><span class="line">        _done = <span class="number">1</span>;</span><br><span class="line">	ptrace(<span class="number">0xb010</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);	<span class="comment">// marks call to _objcInit</span></span><br><span class="line">	__initialize_objc();</span><br><span class="line">	<span class="comment">/* We delay this until here, because dyld cannot detect and</span></span><br><span class="line"><span class="comment">	 * properly order calls to ObjC initializers amongst the</span></span><br><span class="line"><span class="comment">	 * calls to module and library initializers. */</span></span><br><span class="line">	for (hidx = <span class="number">0</span>; hidx &lt; header_count; hidx += <span class="number">1</span>)</span><br><span class="line">		_objc_call_loads_for_image (&amp;header_vector[hidx]);</span><br><span class="line">	ptrace(<span class="number">0xb01f</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);	<span class="comment">// marks call to _objcInit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ˜¯ä»¥ä¸‹è¿™æ®µä»£ç <br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> _done = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> hidx;</span><br><span class="line">        <span class="comment">/* Protect against multiple invocations, as all library</span></span><br><span class="line"><span class="comment">         * initializers should. */</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> != _done) <span class="keyword">return</span>;</span><br><span class="line">        _done = <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p>
<p>æ­£å¦‚ä»–æ‰€å†™çš„ï¼Œè¿™ä¸ªé€»è¾‘é˜²æ­¢äº†è¢«å¤šæ¬¡è°ƒç”¨æ‰§è¡Œï¼Œä¿è¯äº†è¯¥æ–¹æ³•åªè¢«æ‰§è¡Œä¸€æ¬¡ã€‚å› ä¸ºä¸€æ—¦ç¬¬ä¸€æ¬¡æ‰§è¡Œäº†ï¼Œé‚£ä¹ˆ<code>_done</code>è¿™ä¸ªå‚æ•°å°±ä¼šè¢«èµ‹å€¼ä¸º1ï¼Œä¹‹åè°ƒç”¨å°±ä¼šç›´æ¥<code>return</code></p>
<p>æ¥ä¸‹æ¥ï¼Œè¿™é‡Œæœ‰ä¸ª<code>ptrace</code>æ–¹æ³•,è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºæ–­ç‚¹è°ƒè¯•å’Œè¿½è¸ªç³»ç»Ÿè°ƒç”¨ã€‚å¯¹äºå®ç°æ•´ä½“çš„é€»è¾‘å®ç°æ²¡æœ‰å¤ªå¤§å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒå¿½ç•¥ã€‚</p>
<p>ä¹‹åè°ƒç”¨äº†<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__initialize_objc()<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>è¯¥æ–¹æ³•æ˜¯åŠ¨æ€é“¾æ¥å™¨ç”¨æ¥åˆå§‹åŒ–åº“æ–‡ä»¶ï¼Œé€šè¿‡å¤´æ–‡ä»¶åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€çš„è¿­ä»£å™¨ï¼Œå¹¶é€šè¿‡ç±»çš„<code>hash</code>è¡¨ï¼Œå’Œå¯¹åº”å¤´æ–‡ä»¶çš„è¿­ä»£å™¨æ¥è·å–<code>class</code>ã€‚</p>
<h2 id="category-éƒ¨åˆ†"><a href="#category-éƒ¨åˆ†" class="headerlink" title="category éƒ¨åˆ†"></a>category éƒ¨åˆ†</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* Library initializer called by dyld. */</span></span><br><span class="line"><span class="keyword">void</span> __initialize_objc(<span class="keyword">void</span>) &#123;</span><br><span class="line">	<span class="keyword">int</span> hidx;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(NeXT_PDO)</span></span><br><span class="line">	<span class="keyword">const</span> headerType * <span class="keyword">const</span> *	headers;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( rocketLaunchingDebug == <span class="number">-1</span> ) &#123;</span><br><span class="line">	    <span class="keyword">if</span> ( getenv(<span class="string">"OBJC_UNIQUE_DEBUG"</span>) ) rocketLaunchingDebug = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> rocketLaunchingDebug = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get architecture dependent module headers</span></span><br><span class="line">	headers = (<span class="keyword">const</span> headerType * <span class="keyword">const</span> *) _getObjcHeaders ();</span><br><span class="line">	<span class="keyword">if</span> (headers)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// Create vector from these headers</span></span><br><span class="line">		header_vector = _objc_headerVector (headers);</span><br><span class="line">		<span class="keyword">if</span> (header_vector) </span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Load classes from all images in the vector</span></span><br><span class="line">			<span class="keyword">for</span> (hidx = <span class="number">0</span>; hidx &lt; header_count; hidx += <span class="number">1</span>)</span><br><span class="line">				(<span class="keyword">void</span>) _objc_get_classes_from_image (class_hash, &amp;header_vector[hidx]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(__MACH__)</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> _done = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">extern</span> <span class="keyword">void</span> __CFInitialize(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/* Protect against multiple invocations, as all library</span></span><br><span class="line"><span class="comment">	 * initializers should. */</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">0</span> != _done) <span class="keyword">return</span>;</span><br><span class="line">	_done = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	ptrace(<span class="number">0xb000</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// make sure CF is initialized before we go further;</span></span><br><span class="line">	<span class="comment">// someday this can be removed, as it'll probably be automatic</span></span><br><span class="line">	__CFInitialize();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Create the class lookup table</span></span><br><span class="line">	_objc_init_class_hash ();</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	ptrace(0xb001, 0, 0, 0);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get our configuration</span></span><br><span class="line">        <span class="keyword">if</span> ( rocketLaunchingDebug == <span class="number">-1</span> ) &#123;</span><br><span class="line">            <span class="keyword">if</span> ( getenv(<span class="string">"OBJC_UNIQUE_DEBUG"</span>) ) rocketLaunchingDebug = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> rocketLaunchingDebug = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//	ptrace(0xb003, 0, 0, 0);</span></span><br><span class="line"></span><br><span class="line">	map_selectors_pended = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// XXXXX BEFORE HERE *NO* PAGES ARE STOMPED ON</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Register our image mapping routine with dyld so it</span></span><br><span class="line">	<span class="comment">// gets invoked when an image is added.  This also invokes</span></span><br><span class="line">	<span class="comment">// the callback right now on any images already present.</span></span><br><span class="line">	_dyld_register_func_for_add_image (&amp;_objc_map_image_callback);</span><br><span class="line">	</span><br><span class="line"><span class="comment">// XXXXX BEFORE HERE *ALL* PAGES ARE STOMPED ON</span></span><br><span class="line"></span><br><span class="line">	map_selectors_pended  = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	ptrace(0xb005, 0, 0, 0);</span></span><br><span class="line">		</span><br><span class="line">	<span class="comment">// Register module link callback with dyld</span></span><br><span class="line">	_dyld_register_func_for_link_module (&amp;_objc_link_module_callback);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Register callback with dyld</span></span><br><span class="line">	_dyld_register_func_for_unlink_module (&amp;_objc_unlink_module_callback);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MACH</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//	ptrace(0xb006, header_count, 0, 0);</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Install relations on classes that were found</span></span><br><span class="line">	<span class="keyword">for</span> (hidx = <span class="number">0</span>; hidx &lt; header_count; hidx += <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span>			nModules;</span><br><span class="line">		<span class="keyword">int</span>			index;</span><br><span class="line">		<span class="class"><span class="keyword">struct</span> <span class="title">objc_module</span> *	<span class="title">module</span>;</span></span><br><span class="line">		<span class="class"><span class="keyword">struct</span> <span class="title">objc_class</span> *	<span class="title">cls</span>;</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">module</span> = (struct objc_module *) ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) header_vector[hidx].mod_ptr + header_vector[hidx].image_slide);</span><br><span class="line">		<span class="keyword">for</span> (nModules = header_vector[hidx].mod_count; nModules; nModules -= <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (index = <span class="number">0</span>; index &lt; <span class="keyword">module</span>-&gt;symtab-&gt;cls_def_cnt; index += <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				cls = (struct objc_class *) <span class="keyword">module</span>-&gt;symtab-&gt;defs[index];</span><br><span class="line">				_class_install_relationships (cls, <span class="keyword">module</span>-&gt;version);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">module</span> += <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//		ptrace(0xb007, hidx, header_vector[hidx].mod_count, 0);</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//	ptrace(0xb008, header_count, 0, 0);</span></span><br><span class="line">		</span><br><span class="line">	<span class="keyword">for</span> (hidx = <span class="number">0</span>; hidx &lt; header_count; hidx += <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(__MACH__)</span></span><br><span class="line">		(<span class="keyword">void</span>)_objc_add_categories_from_image (&amp;header_vector[hidx]);</span><br><span class="line">		(<span class="keyword">void</span>) _objc_fixup_selector_refs (&amp;header_vector[hidx]);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">		<span class="comment">// Initialize the isa pointers of all NXConstantString objects</span></span><br><span class="line">		(<span class="keyword">void</span>)_objc_fixup_string_objects_for_image (&amp;header_vector[hidx]);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Convert class refs from name pointers to ids</span></span><br><span class="line">		(<span class="keyword">void</span>)_objc_map_class_refs_for_image (&amp;header_vector[hidx]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//	ptrace(0xb00a, 0, 0, 0);</span></span><br><span class="line">		</span><br><span class="line">	<span class="comment">// For each image selectorize the method names and +_fixup each of</span></span><br><span class="line">	<span class="comment">// protocols in the image</span></span><br><span class="line">	<span class="keyword">for</span> (hidx = <span class="number">0</span>; hidx &lt; header_count; hidx += <span class="number">1</span>)</span><br><span class="line">		_objc_fixup_protocol_objects_for_image (&amp;header_vector[hidx]);</span><br><span class="line">	</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(WIN32) || defined(__svr4__)</span></span><br><span class="line">	CMH = (objcModHeader *) <span class="number">0</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	ptrace(<span class="number">0xb00f</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);	<span class="comment">// end of ObjC init</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šçš„æ–¹æ³•ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•å°±æ˜¯</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_objc_get_classes_from_image<span class="comment">()</span></span><br></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬ç»§ç»­å¾€é‡Œæ·±å…¥è¿™ä¸ªæ–¹æ³•</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***********************************************************************</span></span><br><span class="line"><span class="comment"> * _objc_get_classes_from_image.  Install all classes contained in the</span></span><br><span class="line"><span class="comment"> * specified image.</span></span><br><span class="line"><span class="comment"> **********************************************************************/</span></span><br><span class="line"><span class="keyword">static</span> NXHashTable *	_objc_get_classes_from_image   (NXHashTable *	clsHash,</span><br><span class="line">														header_info *	hi)</span><br><span class="line">&#123;</span><br><span class="line">	unsigned int	index;</span><br><span class="line">	unsigned int	midx;</span><br><span class="line">	Module			mods;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Major loop - process all modules in the image</span></span><br><span class="line">	mods = (Module) ((unsigned long) hi-&gt;mod_ptr + hi-&gt;image_slide);</span><br><span class="line">	<span class="keyword">for</span> (midx = <span class="number">0</span>; midx &lt; hi-&gt;mod_count; midx += <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// Skip module containing no classes</span></span><br><span class="line">		<span class="keyword">if</span> (mods[midx].symtab == NULL)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// Minor loop - process all the classes in given module</span></span><br><span class="line">		<span class="keyword">for</span> (index = <span class="number">0</span>; index &lt; mods[midx].symtab-&gt;cls_def_cnt; index += <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">		struct objc_class *	oldCls;</span><br><span class="line">		struct objc_class *	<span class="keyword">new</span><span class="type">Cls</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// Locate the class description pointer</span></span><br><span class="line">			<span class="keyword">new</span><span class="type">Cls</span> = mods[midx].symtab-&gt;defs[index];</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// Convert old style method list to the new style</span></span><br><span class="line">			_objcTweakMethodListPointerForClass (<span class="keyword">new</span><span class="type">Cls</span>);</span><br><span class="line"></span><br><span class="line">			oldCls = NXHashInsert (clsHash, <span class="keyword">new</span><span class="type">Cls</span>);</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Non-Nil oldCls is a class that NXHashInsert just</span></span><br><span class="line">			<span class="comment">// bumped from table because it has the same name</span></span><br><span class="line">			<span class="comment">// as newCls</span></span><br><span class="line">			<span class="keyword">if</span> (oldCls)</span><br><span class="line">			&#123;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">if</span> defined(__MACH__)</span></span><br><span class="line">				const header_info *	oldHeader;</span><br><span class="line">				const header_info *	<span class="keyword">new</span><span class="type">Header</span>;</span><br><span class="line">				const char *		oldName;</span><br><span class="line">				const char *		<span class="keyword">new</span><span class="type">Name</span>;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// Log the duplication</span></span><br><span class="line">				oldHeader = _headerForClass (oldCls);</span><br><span class="line">				<span class="keyword">new</span><span class="type">Header</span> = _headerForClass (<span class="keyword">new</span><span class="type">Cls</span>);</span><br><span class="line">				oldName   = _nameForHeader  (oldHeader-&gt;mhdr);</span><br><span class="line">				<span class="keyword">new</span><span class="type">Name</span>   = _nameForHeader  (<span class="keyword">new</span><span class="type">Header</span>-&gt;mhdr);</span><br><span class="line">				_objc_inform (<span class="string">"Both %s and %s have implementations of class %s."</span>,</span><br><span class="line">								oldName, <span class="keyword">new</span><span class="type">Name</span>, oldCls-&gt;name);				   </span><br><span class="line">				_objc_inform (<span class="string">"Using implementation from %s."</span>, <span class="keyword">new</span><span class="type">Name</span>);</span><br><span class="line">                <span class="meta">#endif</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">// Use the chosen class</span></span><br><span class="line">				<span class="comment">// <span class="doctag">NOTE:</span> Isn't this a NOP?</span></span><br><span class="line">				<span class="keyword">new</span><span class="type">Cls</span> = objc_lookUpClass (oldCls-&gt;name);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// Unless newCls was a duplicate, and we chose the</span></span><br><span class="line">			<span class="comment">// existing one instead, set the version in the meta-class</span></span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">new</span><span class="type">Cls</span> != oldCls)</span><br><span class="line">				<span class="keyword">new</span><span class="type">Cls</span>-&gt;isa-&gt;version = mods[midx].version;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// Install new categories intended for this class</span></span><br><span class="line">			<span class="comment">// <span class="doctag">NOTE:</span> But, if we displaced an existing "isEqual"</span></span><br><span class="line">			<span class="comment">// class, the categories have already been installed</span></span><br><span class="line">			<span class="comment">// on an old class and are gone from the registry!!</span></span><br><span class="line">			_objc_resolve_categories_for_class (<span class="keyword">new</span><span class="type">Cls</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// Resolve (a) pointers to the named class, and/or</span></span><br><span class="line">			<span class="comment">// (b) the super_class, cache, and version</span></span><br><span class="line">			<span class="comment">// fields of newCls and its meta-class</span></span><br><span class="line">			<span class="comment">// <span class="doctag">NOTE:</span> But, if we displaced an existing "isEqual"</span></span><br><span class="line">			<span class="comment">// class, this has already been done... with an</span></span><br><span class="line">			<span class="comment">// old-now-"unused" class!!</span></span><br><span class="line">			checkForPendingClassReferences (<span class="keyword">new</span><span class="type">Cls</span>);</span><br><span class="line">			</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(NeXT_PDO) // GENERIC_OBJ_FILE</span></span><br><span class="line">			<span class="comment">// Invoke registered callback</span></span><br><span class="line">			<span class="keyword">if</span> (load_class_callback)</span><br><span class="line">				(*load_class_callback) (<span class="keyword">new</span><span class="type">Cls</span>, <span class="number">0</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// Call +finishLoading:: from the class' method list</span></span><br><span class="line">			send_load_message_to_class (<span class="keyword">new</span><span class="type">Cls</span>, (headerType *) hi-&gt;mhdr);</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Return the table the caller passed</span></span><br><span class="line">	<span class="keyword">return</span> clsHash;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»é¡¶éƒ¨çš„æ³¨é‡Šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºåŠ è½½æŒ‡å®šé•œåƒä¸­çš„æ‰€æœ‰çš„ç±»<br>è¿™é‡Œæˆ‘ä»¬å…³æ³¨çš„æ˜¯categoryçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°è¡Œä»£ç <br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   // <span class="keyword">Install</span> <span class="keyword">new</span> categories intended <span class="keyword">for</span> this <span class="keyword">class</span></span><br><span class="line">// NOTE: But, <span class="keyword">if</span> we displaced an existing <span class="string">"isEqual"</span></span><br><span class="line">// <span class="keyword">class</span>, the categories have already been installed</span><br><span class="line">// <span class="keyword">on</span> an <span class="keyword">old</span> <span class="keyword">class</span> <span class="keyword">and</span> <span class="keyword">are</span> gone <span class="keyword">from</span> the registry!!</span><br><span class="line">_objc_resolve_categories_for_class (newCls);</span><br></pre></td></tr></table></figure></p>
<p>è¯¥æ–¹æ³•è¢«ç”¨äºåŠ è½½æ–°çš„<code>category</code>ï¼Œæ³¨é‡Šä¸­ä¹Ÿæåˆ°äº†ï¼Œå¦‚æœæˆ‘ä»¬å–ä»£äº†å·²ç»å­˜åœ¨çš„åŒä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆä¹‹å‰å·²ç»è¢«åŠ è½½åœ¨æ—§çš„ç±»ä¸Šçš„<code>category</code>å°±ä¼šä»å¯„å­˜å™¨ä¸­æ¶ˆå¤±</p>
<p>å¯¹åº”çš„æ˜¯ç°å®è¿™æ ·çš„</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * <span class="emphasis">_objc_</span>resolve<span class="emphasis">_categories_</span>for_class.  Install all categories intended</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * for </span>the<span class="markdown"> specified class, in reverse order from </span>the<span class="markdown"> order in which we</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * found </span>the<span class="markdown"> categories in </span>the<span class="markdown"> image.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> <span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span>	_objc_resolve_categories_for_class  (struct objc_class *	cls)</span><br><span class="line">&#123;</span><br><span class="line">	_objc_unresolved_category *	cat;</span><br><span class="line">	_objc_unresolved_category *	next;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Nothing to do if there are no categories at all</span></span><br><span class="line">	<span class="keyword">if</span> (!category_hash)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Locate and remove first element in category list</span></span><br><span class="line">	<span class="comment">// associated with this class</span></span><br><span class="line">	cat = NXMapRemove (category_hash, cls-&gt;name);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Traverse the list of categories, if any, registered for this class</span></span><br><span class="line">	<span class="keyword">while</span> (cat)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// Install the category</span></span><br><span class="line">		_objc_add_category (cat-&gt;cat, cat-&gt;version);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// Delink and reclaim this registration</span></span><br><span class="line">		next = cat-&gt;next;</span><br><span class="line">		free (cat);</span><br><span class="line">		cat = next;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬è§‚å¯Ÿåˆ°æœ‰ä¸ªå«<code>category_hash</code>çš„å“ˆå¸Œè¡¨ï¼Œä¹‹åéå†å•å‘é“¾è¡¨ç»“æ„ï¼Œå°†å¯¹åº”çš„<code>category</code>æ·»åŠ åˆ°å¯¹è±¡ä¸­</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¼šæœ‰ä¸¤ä¸ªç–‘é—®ğŸ¤”ï¸</p>
<p>1.<code>category_hash</code>è¿™ä¸ªå˜é‡é‚£é‡Œæ¥çš„ï¼Ÿ<br>2.<code>_objc_add_category</code>åˆåšäº†ä»€ä¹ˆæ“ä½œï¼Ÿ</p>
<hr>
<p>é‚£ä¹ˆæˆ‘ä»¬å…ˆè§£ç­”ç¬¬ä¸€ä¸ª</p>
<blockquote>
<p>1.<code>category_hash</code>è¿™ä¸ªå˜é‡é‚£é‡Œæ¥çš„ï¼Ÿ</p>
</blockquote>
<p>äº‹å®ä¸Šï¼Œ<code>category_hash</code>æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡<br><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Category <span class="literal">and</span> <span class="class"><span class="keyword">class</span> <span class="title">registries</span></span></span><br><span class="line">static NXMapTable *		category_hash = <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure></p>
<p>åœ¨<code>__initialize_objc()</code>è¿™ä¸ªæ–¹æ³•ä¸­æœ‰è¿™æ ·ä¸€è¡Œä»£ç </p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="comment">// Register our image mapping routine with dyld so it</span></span><br><span class="line"><span class="comment">// gets invoked when an image is added.  This also invokes</span></span><br><span class="line"><span class="comment">// the callback right now on any images already present.</span></span><br><span class="line"><span class="variable">_dyld_register_func_for_add_image</span> (&amp;<span class="variable">_objc_map_image_callback</span>);</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªæ–¹å¼ä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥äº†ä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æ¯ä¸ªé•œåƒè¢«åŠ è½½çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒæ–¹æ³•ï¼Œå…·ä½“å¯è§<a href="http://mirror.informatimago.com/next/developer.apple.com/documentation/DeveloperTools/Conceptual/MachORuntime/5rt_api_reference/chapter_11_section_46.html" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
<p>ä¹‹åç»è¿‡ä¸€ç³»åˆ—è°ƒç”¨æœ€ç»ˆåœ¨<code>_objc_register_category</code>è¿™ä¸ªæ–¹æ³•ä¸­åˆ›å»ºäº†è¿™ä¸ª<code>category</code>å“ˆå¸Œè¡¨</p>
<p><strong>æ‰€ä»¥</strong></p>
<p>è¿™ä¸ªå“ˆå¸Œè¡¨çš„åˆ›å»ºæ˜¯åœ¨æ¯æ¬¡é•œåƒè¢«åŠ è½½æ—¶åˆ›å»ºçš„ï¼ŒåŒæ—¶ä»–ä¹Ÿä¼šå»åšå¯¹æ¯”ï¼Œå¦‚æœå‡ºç°é‡å¤å°±ä¼šè¿›è¡Œæ›¿æ¢æ“ä½œ</p>
<hr>
<blockquote>
<p>2.<code>_objc_add_category</code>åˆåšäº†ä»€ä¹ˆæ“ä½œï¼Ÿ</p>
</blockquote>
<p>ç›´æ¥çœ‹ä»£ç </p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * <span class="emphasis">_objc_</span>add_category.  Install </span>the<span class="markdown"> specified category's methods into</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * </span>the<span class="markdown"> class it augments, and flush </span>the<span class="markdown"> class' method cache.</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> *</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> * Private extern used by objc_loadModules ()</span></span></span><br><span class="line"><span class="comment"><span class="markdown"> <span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>/</span></span></span><br><span class="line"><span class="keyword">void</span>	_objc_add_category     (struct objc_category *	category,</span><br><span class="line">								<span class="built_in">int</span>						version)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// Install the category's methods into its intended class</span></span><br><span class="line">	__objc_add_category (category, version);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Flush caches so category's methods can get called</span></span><br><span class="line">	_objc_flush_caches (objc_lookUpClass (category-&gt;class_name));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨é‡Šååˆ†æ¸…æ™°ï¼Œä¸»è¦å¹²äº†<strong>ä¸¤ä»¶äº‹</strong></p>
<ul>
<li>1.åŠ è½½ç‰¹å®šç±»æ–¹æ³•</li>
<li>2.åˆ·æ–°ç±»çš„æ–¹æ³•ç¼“å­˜</li>
</ul>
<p>å…³äº<code>__objc_add_category</code>æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥å»æ·±å…¥</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***********************************************************************</span></span><br><span class="line"><span class="comment"> * __objc_add_category.  Install the specified category's methods and</span></span><br><span class="line"><span class="comment"> * protocols into the class it augments.</span></span><br><span class="line"><span class="comment"> **********************************************************************/</span></span><br><span class="line">static inline void	__objc_add_category    (struct objc_category *	category,</span><br><span class="line">											int						version)</span><br><span class="line">&#123;</span><br><span class="line">	struct objc_class *	cls;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Locate the class that the category will extend</span></span><br><span class="line">	<span class="function"><span class="title">cls</span> = (struct objc_class *) objc_getClass (category-&gt;</span>class_name);</span><br><span class="line">	<span class="keyword">if</span> (!cls)</span><br><span class="line">	&#123;</span><br><span class="line">		_<span class="function"><span class="title">objc_inform</span> ("unable to add category %s...\n", category-&gt;</span>category_name);</span><br><span class="line">		_<span class="function"><span class="title">objc_inform</span> ("class `%s' <span class="built_in">not</span> linked into application\n", category-&gt;</span>class_name);</span><br><span class="line">		return;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Augment instance methods</span></span><br><span class="line">	<span class="function"><span class="title">if</span> (category-&gt;</span>instance_methods)</span><br><span class="line">		_<span class="function"><span class="title">objc_insertMethods</span> (category-&gt;</span><span class="function"><span class="title">instance_methods</span>, &amp;cls-&gt;</span>methodLists);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Augment class methods</span></span><br><span class="line">	<span class="function"><span class="title">if</span> (category-&gt;</span>class_methods)</span><br><span class="line">		_<span class="function"><span class="title">objc_insertMethods</span> (category-&gt;</span><span class="function"><span class="title">class_methods</span>, &amp;cls-&gt;</span><span class="function"><span class="title">isa</span>-&gt;</span>methodLists);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Augment protocols</span></span><br><span class="line">	<span class="function"><span class="title">if</span> ((version &gt;= 5) &amp;&amp; category-&gt;</span>protocols)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function"><span class="title">if</span> (cls-&gt;</span><span class="function"><span class="title">isa</span>-&gt;</span>version &gt;= <span class="number">5</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="function"><span class="title">category</span>-&gt;</span><span class="function"><span class="title">protocols</span>-&gt;</span><span class="function"><span class="title">next</span> = cls-&gt;</span>protocols;</span><br><span class="line">			<span class="function"><span class="title">cls</span>-&gt;</span><span class="function"><span class="title">protocols</span>	          = category-&gt;</span>protocols;</span><br><span class="line">			<span class="function"><span class="title">cls</span>-&gt;</span><span class="function"><span class="title">isa</span>-&gt;</span><span class="function"><span class="title">protocols</span>       = category-&gt;</span>protocols;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			_<span class="function"><span class="title">objc_inform</span> ("unable to add protocols from category %s...\n", category-&gt;</span>category_name);</span><br><span class="line">			_<span class="function"><span class="title">objc_inform</span> ("class `%s' must be recompiled\n", category-&gt;</span>class_name);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">#<span class="keyword">if</span> defined(NeXT_PDO) <span class="comment">// GENERIC_OBJ_FILE</span></span><br><span class="line">	<span class="comment">// Call back</span></span><br><span class="line">	<span class="keyword">if</span> (load_class_callback)</span><br><span class="line">		(*load_class_callback) (cls, <span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// Call +finishLoading:: from the category's method list</span></span><br><span class="line">	send_load_message_to_category (category, (void *) header_vector[<span class="number">0</span>].mhdr);</span><br><span class="line">#endif</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»–ä¼šåˆ†åˆ«å¯¹<strong>å®ä¾‹å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨</strong>å’Œ<strong>ç±»å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨</strong>åˆ†åˆ«æ·»åŠ å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•ã€‚</p>
<p>æ€»ç»“ï¼š </p>
<p>1.dyldåœ¨æ¯æ¬¡åŠ è½½é•œåƒçš„æ—¶å€™ï¼Œéƒ½ä¼šè°ƒç”¨å›è°ƒæ–¹æ³•ï¼Œè®©ç³»ç»Ÿç”Ÿæˆç±»å¯¹åº”çš„<code>category</code>å“ˆå¸Œè¡¨<br>2.æ¯æ¬¡å¯¹åº”æ·»åŠ æ–¹æ³•æ—¶éƒ½ä¼šæ˜¯åˆ†åˆ«æ·»åŠ å¯¹åº”çš„å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/06/25/åŠ å¯†ç›¸å…³ï¼ˆäºŒï¼‰/">
                åŠ å¯†ç›¸å…³ï¼ˆäºŒï¼‰
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2018-06-25
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Read-iOS/">Read iOS</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>åŸºäºç¬¬ä¸€ç¯‡æ–‡ç« çš„ä»‹ç»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥èŠèŠæ—¥å¸¸ç”Ÿæ´»ä¸­çš„éƒ½ä¼šæ¥è§¦åˆ°çš„åŠ å¯†åº”ç”¨æ–¹å¼â€“<code>HTTPS</code></p>
<h2 id="HTTP-vs-HTTPS"><a href="#HTTP-vs-HTTPS" class="headerlink" title="HTTP vs HTTPS"></a>HTTP vs HTTPS</h2><p><code>HTTP</code>å…¨ç§°<code>Hyper Text Transfer Protocal</code>(è¶…æ–‡æœ¬ä¼ è¾“åè®®)æ˜¯ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åè®®åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ï¼Œæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ã€‚</p>
<p><code>HTTPS</code>å…¨ç§°<code>Secure Hypertext Transfer Protocol</code>å®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®ã€‚</p>
<h2 id="SSL-or-TLS"><a href="#SSL-or-TLS" class="headerlink" title="SSL or TLS"></a>SSL or TLS</h2><p>åœ¨<code>HTTPS</code>ä¸­çš„<code>S</code>å¯ä»¥æ˜¯<code>SSL</code>æˆ–è€…<code>TLS</code>ã€‚</p>
<p><code>SSL</code>å…¨ç§°<code>Secure Socket Layer</code>å®‰å…¨å¥—æ¥å­—å±‚ï¼Œä½äºå¯é çš„é¢å‘è¿æ¥çš„ç½‘ç»œåè®®å’Œåº”ç”¨å±‚åè®®å±‚ã€‚<code>SSL</code>é€šè¿‡äº’ç›¸è®¤è¯ã€ä½¿ç”¨æ•°å­—è¯ä¹¦ä¿è¯å®Œæ•´æ€§ï¼Œä½¿ç”¨åŠ å¯†ç¡®ä¿ç§å¯†æ€§ï¼Œä»¥å®ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„å®‰å…¨é€šè®¯ã€‚è¯¥åè®®ç”±ä¸¤å±‚ç»„æˆ: <code>SSL</code>è®°å½•åè®®å’Œ<code>SSL</code>æ¡æ‰‹åè®®ã€‚<code>SSL</code>æ˜¯<code>Netscape</code>å¼€å‘çš„ä¸“é—¨ç”¨äºä¿æŠ¤<code>Web</code>é€šè®¯çš„ã€‚</p>
<p><code>TLS</code>å…¨ç§°<code>Transport Layer Security</code>å®‰å…¨ä¼ è¾“å±‚åè®®ï¼Œç”¨äºä¸¤ä¸ªåº”ç”¨ä¹‹é—´æä¾›ä¿å¯†æ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚è¯¥åè®®ç”±ä¸¤å±‚ç»„æˆ:  <code>TSL</code>è®°å½•åè®®å’Œ<code>TSL</code>æ¡æ‰‹åè®®ã€‚<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2018/06/25/åŠ å¯†ç›¸å…³ï¼ˆäºŒï¼‰/#more">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/06/02/setTimeoutæ¢ç´¢/">
                setTimeoutæ¢ç´¢
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2018-06-02
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/FrontEnd/">FrontEnd</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h2><blockquote>
<p>å¹¶å‘&amp;&amp;å¹¶è¡Œ</p>
</blockquote>
<p><strong>å¹¶å‘å¤šçº¿ç¨‹</strong> : <code>ConCurrency</code> , å®è´¨å°±æ˜¯ä¸€ä¸ªç‰©ç†çš„<code>CPU</code>åœ¨è‹¥å¹²ä¸ªç¨‹åºä¹‹é—´å¤ç”¨ï¼Œç”±äºæ¯æ¬¡åˆ‡æ¢æ‰§è¡Œç¨‹åºçš„æ—¶é—´æçŸ­ï¼Œæ‰€ä»¥ä¸€èˆ¬ç”¨æˆ·æ— æ³•å¯Ÿè§‰ï¼Œå³è®¤ä¸ºæ˜¯å¤šä¸ªåº”ç”¨åœ¨åŒæ—¶æ‰§è¡Œã€‚<br><strong>å¹¶è¡Œå¤šçº¿ç¨‹</strong> : <code>Paralleism</code> , æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„äº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»å‘ç”Ÿï¼Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸åŒäº‹ä»¶åœ¨åŒä¸€ä¸ªæ—¶åˆ»å‘é€ã€‚</p>
<blockquote>
<p>JSçº¿ç¨‹</p>
</blockquote>
<p>æµè§ˆå™¨å†…æ ¸æ˜¯å¤šçº¿ç¨‹çš„ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼šä¿ç•™è‡³å°‘ä¸‰ä¸ªåŸºæœ¬çº¿ç¨‹ï¼š<strong>JSå¼•æ“çº¿ç¨‹</strong>ã€<strong>GUIæ¸²æŸ“çº¿ç¨‹</strong>ã€<strong>æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹</strong></p>
<p><strong>JSå¼•æ“çº¿ç¨‹</strong>: åŸºäºäº‹ä»¶æ‰§è¡Œï¼Œå•çº¿ç¨‹å¤„ç†ï¼Œæ„å‘³ç€ä»»åŠ¡éƒ½æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªé¡ºåºæ‰§è¡Œçš„ã€‚<br><strong>GUIæ¸²æŸ“çº¿ç¨‹</strong>: è´Ÿè´£æ¸²æŸ“æµè§ˆå™¨ç•Œé¢<br><strong>æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹</strong>: å½“ä¸€ä¸ªäº‹ä»¶è§¦å‘æ—¶è¯¥çº¿ç¨‹ä¼šæŠŠäº‹ä»¶æ·»åŠ åˆ°<code>JSå¼•æ“çº¿ç¨‹</code>çš„å¾…å¤„ç†é˜Ÿåˆ—çš„é˜Ÿå°¾ä¸­</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2018/06/02/setTimeoutæ¢ç´¢/#more">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/05/23/åŠ å¯†ç›¸å…³ï¼ˆä¸€ï¼‰/">
                åŠ å¯†ç›¸å…³ï¼ˆä¸€ï¼‰
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2018-05-23
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/Read/">Read</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <blockquote>
<p>å‰è¨€ï¼š<br> <strong>è¿™ä¼šæ˜¯ä¸€ç¯‡ä¸»è®²åŠ å¯†ç›¸å…³çš„æ–‡ç« ï¼Œå¸Œæœ›èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šç†æ¸…æ—¥å¸¸ä½¿ç”¨çš„åŠ å¯†æ¦‚å¿µã€‚</strong></p>
</blockquote>
<h3 id="å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†ä¸éå¯¹ç§°åŠ å¯†</h3><p>é¦–å…ˆï¼Œç°æœ‰çš„åŠ å¯†æŠ€æœ¯åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§å«<code>å¯¹ç§°åŠ å¯†</code>ï¼Œå³åœ¨åŠ å¯†å’Œè§£å¯†çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯†é’¥ã€‚å¦ä¸€ç§å«<code>éå¯¹ç§°åŠ å¯†</code>ï¼Œè¿™ç§åŠ å¯†æŠ€æœ¯ä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªæ¦‚å¿µâ€”ç§é’¥å’Œå…¬é’¥ã€‚ç§é’¥ä¸€èˆ¬æ˜¯æŒ‡ï¼Œç”¨äºåŠ å¯†åŸæ–‡çš„ä¸å‘å¤–ç•Œé€éœ²çš„å¯†é’¥ã€‚å…¬é’¥åˆ™æƒ³æ³•ï¼Œä¸€èˆ¬æ˜¯æŒ‡å‘å¤–ç•Œé€éœ²çš„ï¼Œç”¨äºè§£å¯†çš„å¯†é’¥ã€‚å…¶ä¸­å…¬é’¥å’Œç§é’¥æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œå³åªæœ‰ç§é’¥å¯¹åº”çš„å…¬é’¥æ‰èƒ½è§£å¯†ç§é’¥åŠ å¯†çš„å¯†æ–‡</p>
<hr>
          <div class="post-more-link text-center">
            <a class="btn" href="/2018/05/23/åŠ å¯†ç›¸å…³ï¼ˆä¸€ï¼‰/#more">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2018/04/12/autoreleasepoolåˆ†æ/">
                autoreleasepoolåˆ†æ
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          Posted on 2018-04-12
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; In
            
              <a href="/categories/ScourceCode/">ScourceCode</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Autorelease pool implementation</span><br><span class="line">A thread's autorelease pool is a stack of pointers. </span><br><span class="line">Each pointer is either an object to <span class="keyword">release</span>, <span class="keyword">or</span> POOL_SENTINEL which <span class="keyword">is</span> </span><br><span class="line"> an autorelease pool boundary.</span><br><span class="line">A pool token <span class="keyword">is</span> a pointer <span class="keyword">to</span> the POOL_SENTINEL <span class="keyword">for</span> that pool. <span class="keyword">When</span> </span><br><span class="line"> the pool <span class="keyword">is</span> popped, every <span class="keyword">object</span> hotter <span class="keyword">than</span> the sentinel <span class="keyword">is</span> released.</span><br><span class="line">The stack <span class="keyword">is</span> divided <span class="keyword">into</span> a doubly-linked <span class="keyword">list</span> <span class="keyword">of</span> pages. Pages <span class="keyword">are</span> added </span><br><span class="line"> <span class="keyword">and</span> deleted <span class="keyword">as</span> necessary. </span><br><span class="line"><span class="keyword">Thread</span>-<span class="keyword">local</span> <span class="keyword">storage</span> points <span class="keyword">to</span> the hot page, <span class="keyword">where</span> newly autoreleased objects <span class="keyword">are</span> stored.</span><br></pre></td></tr></table></figure>
<p>ç¿»è¯‘ï¼š<br>ä¸€ä¸ªçº¿ç¨‹çš„è‡ªåŠ¨é‡Šæ”¾æ± æ˜¯ä¸€å †æŒ‡é’ˆã€‚æŒ‡é’ˆè¦ä¹ˆæ˜¯ä¸€ä¸ª<code>release</code>å¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª<code>POOL_SENTINEL</code> â€” <code>POOL_SENTINEL</code>æ˜¯ä¸€ä¸ªè‡ªåŠ¨å›æ”¶æ± è¾¹ç•Œ</p>
<p>ä¸€ä¸ª<code>pool token</code>å¯¹äºé‚£ä¸ªé‡Šæ”¾æ± æ¥è®²æ˜¯ä¸€ä¸ªæŒ‡å‘<code>POOL_SENTINEL</code>(æ± å­å“¨å…µ)çš„æŒ‡é’ˆã€‚å½“æ± å­è¢«é‡Šæ”¾æ—¶ï¼Œæ¯ä¸ªæ¯”å“¨å…µhotterçš„å¯¹è±¡éƒ½è¦è¢«é‡Šæ”¾â€“ä¸æ˜¯å¾ˆæ‡‚ã€‚è¿™ä¸ªæ ˆè¢«åˆ’åˆ†ä¸ºä¸€ç³»åˆ—åŒå‘åˆ—è¡¨ï¼Œåˆ—è¡¨æ ¹æ®éœ€è¦æ·»åŠ æˆ–è€…åˆ é™¤</p>
<p>TLSæŒ‡é’ˆæŒ‡å‘<code>hot page</code>ï¼Œä»–å°±æ˜¯æœ€æ–°çš„è‡ªåŠ¨é‡Šæ”¾å¯¹å¯¹è±¡å­˜å‚¨çš„åœ°æ–¹<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2018/04/12/autoreleasepoolåˆ†æ/#more">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
  </div>

  
  <div class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">&raquo;</a>
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="http://7xjg07.com1.z0.glb.clouddn.com/u=3987586330,3835281882&fm=21&gp=0.jpg" alt="Deeer" />
          <p class="site-author-name">Deeer</p>
        </div>
        <p class="site-description motion-element">ä»£ç æ‰‹å·¥è‰ºäºº | Love Linux  | è¿½æ±‚ä½“éªŒ</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">14</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">8</span>
              <span class="site-state-item-name">categories</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">11</span>
              <span class="site-state-item-name">tags</span>
              </a>
          </div>

        </div>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml">
              <i class="menu-item-icon icon-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="http://weibo.com/2941461951/profile?topnav=1&wvr=6" target="_blank">weibo</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://github.com/Deeer" target="_blank">github</a>
            </span>
            
          
        </div>

        
        

      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp;  2015 - 
  2018
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Deeer</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js"></script>


  <script type="text/javascript" src="/js/helpers.js"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js" id="motion.global"></script>




  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  
  

  




  
  

</body>
</html>
